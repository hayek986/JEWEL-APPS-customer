workflows:
  # === سير العمل القديم (للمقارنة) ===
  simulator-build:
    name: Simulator Build
    environment:
      flutter: stable
      xcode: latest
    scripts:
      - flutter pub get
      - flutter build ios --simulator --no-codesign
    artifacts:
      - build/ios/**/*.app

  # === سير العمل الجديد مع خطوة البحث (Debug) ===
  build-ios-unsigned-ipa:
    name: Build Unsigned iOS IPA
    environment:
      flutter: stable
      xcode: latest
    scripts:
      - flutter pub get
      - flutter build ipa --release --no-codesign
      - echo "Searching for the generated .ipa file..."
      - find $CM_BUILD_DIR -name "*.ipa" # <-- هذه هي الخطوة الجديدة
    artifacts:
      - build/ios/ipa/*.ipa
